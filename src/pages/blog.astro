---
import BaseLayout from '../layouts/BaseLayout.astro';
import '../styles/global.css';
import { getCollection } from 'astro:content';

const pageTitle = "Blog Page ðŸ’»";
const posts = await getCollection('posts');

// Define the expected shape of post frontmatter
interface PostData {
    url: string;
  title: string;
  pubDate: Date;
  author: string;
  description?: string;  // Optional
  image?: {
    url: string;
    alt: string;
  };  // Optional
  tags?: string[];  // Optional
}

// Add error handling
if (!posts) {
  throw new Error('No posts found in the collection');
}
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>{pageTitle}</title>
        <style>
            li {
                margin-bottom: 10px;
            }
        </style>
	</head>
	<body>
        <BaseLayout pageTitle = {pageTitle}>

        <h1>My Astro Learning Blog</h1>
        <h2>... view interesting articles here!</h2>

        <p>This is where I will post about my journey learning Astro.</p>

        <ul>
            {posts.map((post) => (
                <li>
                    <a href={post.data.url}>{post.data.title}</a>
                    <p>Published: {post.data.pubDate.toLocaleDateString()}</p>
                    <p>Author: {post.data.author}</p>
                </li>
            ))}
        </ul>

        </BaseLayout>
        <script>
            import "../scripts/menu.js";
        </script>
    </body>
</html>
